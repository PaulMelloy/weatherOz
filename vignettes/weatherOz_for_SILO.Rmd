
---
title: "weatherOz for SILO"
author: "Rodrigo Pires, Anna Hepworth, Rebecca O'Leary and Adam H. Sparks"
output:
  rmarkdown::html_vignette:
    toc: true
vignette: >
  %\VignetteIndexEntry{weatherOz for SILO}
  %\VignetteEngine{knitr::rmarkdown_notangle}
  %\VignetteEncoding{UTF-8}
bibliography: bibliography.bib
---



## About SILO Data

[Queensland Scientific Information for Landowners (SILO)](https://www.longpaddock.qld.gov.au/silo/about/) data sets are constructed from observational records provided by the Bureau of Meteorology (BOM).
SILO interpolates the raw data to fill missing data creating data sets that are spatially and temporally complete [@Jeffrey2001].

## A Note on API Keys

All examples in this vignette assume that you have stored your API key in your .Renviron file.
See [Chapter 8](https://rstats.wtf/r-startup.html#renviron) in "What They Forgot to Teach You About R" by Bryan _et al._ for more on storing details in your .Renviron if you are unfamiliar.

## Working With SILO Data

Four functions are provided to streamline fetching data from the SILO API endpoints.

 * `get_data_drill()`, which returns weather data from SILO's 0.05 x 0.05 degrees interpolated, gridded weather dataset;
 * `get_patched_point()`, which returns weather data from a given BOM weather station (a point) in the SILO database where missing values are interpolated (patched);
 * `get_data_drill_apsim()`, which returns data drill weather data in an {apsimx} `.met` class object with the weather data ready for use in APSIM; and
 * `get_patched_point_apsim()`, which returns patched point weather data in an {apsimx} `.met` class object with the weather data ready for use in APSIM.

## Available Values

`get_data_drill()` and `get_patched_point()` both accept the following values.
`get_data_drill_apsim()` and `get_patched_point_apsim()` return a canned set of values for use in APSIM, because of this, they do not accept a `values` argument.

<dl>
  <dt>all</dt><dd>Which will return all of the following values</dd>
  <dt>max_temp (degrees C)</dt><dd>Maximum temperature</dd>
  <dt>min_temp (degrees C)</dt><dd>Minimum temperature</dd>
  <dt>vp (hPa)</dt><dd>Vapour pressure</dd>
  <dt>vp_deficit (hPa)</dt><dd>Vapour pressure deficit</dd>
  <dt>evap_pan (mm)</dt><dd>Class A pan evaporation</dd>
  <dt>evap_syn (mm)</dt><dd>Synthetic estimate [@Rayner2005]</dd>
  <dt>evap_comb (mm)</dt><dd>Combination (synthetic estimate pre-1970, class A pan 1970 onwards)</dd>
  <dt>evap_morton_lake (mm)</dt><dd>Morton's shallow lake evaporation</dd>
  <dt>radiation (Mj/m [@Morton1983])</dt><dd>Solar exposure, consisting of both direct and diffuse components</dd>
  <dt>rh_tmax (%)</dt><dd>Relative humidity at the time of maximum temperature</dd>
  <dt>rh_tmin (%)</dt><dd>Relative humidity at the time of minimum temperature</dd>
  <dt>et_short_crop (mm)</dt><dd>FAO56 [@Allen1998] short crop</dd>
  <dt>et_tall_crop (mm)</dt><dd>ASCE [@Walter2000] tall crop [@Jeffrey2001]</dd>
  <dt>et_morton_actual (mm)</dt><dd>Morton's areal actual evapotranspiration</dd>
  <dt>et_morton_potential (mm)</dt><dd>Morton's point potential evapotranspiration</dd>
  <dt>et_morton_wet (mm)</dt><dd>Morton's wet-environment areal potential evapotranspiration over land</dd>
  <dt>mslp (hPa)</dt><dd>Mean sea level pressure</dd>
</dl>

## Value Information

Solar radiation: total incoming downward shortwave radiation on a horizontal surface, derived from estimates of cloud oktas and sunshine duration [@Zajaczkowski2013].

Relative humidity: calculated using the vapour pressure measured at 9am, and the saturation vapour pressure computed using either the maximum or minimum temperature [@Jeffrey2001].

Evaporation and evapotranspiration: an overview of the variables provided by SILO is available as a [https://data.longpaddock.qld.gov.au/static/publications/Evapotranspiration_overview.pdf](PDF).

## Data Codes

Where possible (depending on the file format), the data are supplied with codes indicating how each datum was obtained.

<dl>
  <dt>0</dt><dd>Official observation as supplied by the Bureau of Meteorology</dd>
  <dt>15</dt><dd>Deaccumulated rainfall (original observation was recorded over a period exceeding the standard 24 hour observation period)</dd>
  <dt>25</dt><dd>Interpolated from daily observations for that date</dd>
  <dt>26</dt><dd>Synthetic Class A pan evaporation, calculated from temperatures, radiation and vapour pressure</dd>
  <dt>35</dt><dd>Interpolated from daily observations using an anomaly interpolation method</dd>
  <dt>75</dt><dd>Interpolated from the long term averages of daily observations for that day of year</dd>
</dl>

The data returned will include columns that denote the source of the data, whether it was an observation or interpolated.

## Getting Data Drill Interpolated Data

The `get_data_drill()` function fetches spatially interpolated data from SILO for any point in Australia.
Note that these data are not observations, but are interpolated surfaced derived by using either by splining or kriging the observational data.
The arguments required to use this function are minimal with few options.
The location as longitude and latitude, `longitude` and `latitude`, values must be provided along with the start date, `start_date` and the api key, `api_key` (your e-mail address).

### Example 1: Get Data Drill Data Using Defaults

Using coordinates for Southwood, Qld, get Data Drill data for all values available starting on 2022-01-01.


``` r
library(weatherOz)

(
  southwood <- get_data_drill(
    latitude = -27.85,
    longitude = 150.05,
    start_date = "20220101",
    api_key = Sys.getenv("SILO_API_KEY")
  )
)
#>      longitude latitude  year month   day       date air_tmax air_tmax_source air_tmin air_tmin_source
#>          <num>    <num> <num> <num> <int>     <Date>    <num>           <int>    <num>           <int>
#>   1:    150.05   -27.85  2022     1     1 2022-01-01     29.7              25     18.8              25
#>   2:    150.05   -27.85  2022     1     2 2022-01-02     33.6              25     16.6              25
#>   3:    150.05   -27.85  2022     1     3 2022-01-03     35.7              25     18.1              25
#>   4:    150.05   -27.85  2022     1     4 2022-01-04     36.3              25     18.1              25
#>   5:    150.05   -27.85  2022     1     5 2022-01-05     36.4              25     20.3              25
#>  ---                                                                                                  
#> 882:    150.05   -27.85  2024     5    31 2024-05-31     23.7              25     14.1              25
#> 883:    150.05   -27.85  2024     6     1 2024-06-01     18.4              25     16.4              25
#> 884:    150.05   -27.85  2024     6     2 2024-06-02     17.8              25      8.2              25
#> 885:    150.05   -27.85  2024     6     3 2024-06-03     17.0              25      5.1              25
#> 886:    150.05   -27.85  2024     6     4 2024-06-04     20.6              75      2.0              25
#>       elev_m et_morton_actual et_morton_actual_source et_morton_potential et_morton_potential_source
#>       <char>            <num>                   <int>               <num>                      <int>
#>   1: 254.5 m              4.3                      26                 7.2                         26
#>   2: 254.5 m              6.2                      26                 9.6                         26
#>   3: 254.5 m              4.3                      26                11.5                         26
#>   4: 254.5 m              5.1                      26                11.1                         26
#>   5: 254.5 m              5.0                      26                10.9                         26
#>  ---                                                                                                
#> 882: 254.5 m              1.0                      26                 3.0                         26
#> 883: 254.5 m              1.4                      26                 1.4                         26
#> 884: 254.5 m              1.5                      26                 2.3                         26
#> 885: 254.5 m              1.6                      26                 2.0                         26
#> 886: 254.5 m              1.2                      26                 2.7                         26
#>      et_morton_wet et_morton_wet_source et_short_crop et_short_crop_source et_tall_crop
#>              <num>                <int>         <num>                <int>        <num>
#>   1:           5.7                   26           5.2                   26          6.3
#>   2:           7.9                   26           7.0                   26          8.6
#>   3:           7.9                   26           7.7                   26          9.9
#>   4:           8.1                   26           7.7                   26          9.7
#>   5:           8.0                   26           7.5                   26          9.4
#>  ---                                                                                   
#> 882:           2.0                   26           2.1                   26          2.8
#> 883:           1.4                   26           1.1                   26          1.3
#> 884:           1.9                   26           1.6                   26          2.1
#> 885:           1.8                   26           1.5                   26          2.0
#> 886:           1.9                   26           2.1                   26          2.9
#>      et_tall_crop_source evap_comb evap_comb_source evap_morton_lake evap_morton_lake_source evap_pan
#>                    <int>     <num>            <int>            <num>                   <int>    <num>
#>   1:                  26       5.0               25              6.0                      26      5.0
#>   2:                  26       9.2               25              8.3                      26      9.2
#>   3:                  26       8.1               25              8.3                      26      8.1
#>   4:                  26       8.6               25              8.5                      26      8.6
#>   5:                  26       6.3               25              8.3                      26      6.3
#>  ---                                                                                                 
#> 882:                  26       1.8               25              2.0                      26      1.8
#> 883:                  26       2.9               25              1.4                      26      2.9
#> 884:                  26       2.6               25              1.9                      26      2.6
#> 885:                  26       2.6               25              1.8                      26      2.6
#> 886:                  26       2.4               75              1.9                      26      2.4
#>      evap_pan_source evap_syn evap_syn_source  extracted   mslp mslp_source radiation radiation_source
#>                <int>    <num>           <int>     <Date>  <num>       <int>     <num>            <int>
#>   1:              25      6.8              26 2024-06-05 1011.8          25      22.6               42
#>   2:              25      9.2              26 2024-06-05 1008.5          25      31.3               42
#>   3:              25     10.5              26 2024-06-05 1005.1          25      31.3               42
#>   4:              25     10.4              26 2024-06-05 1005.1          25      31.3               42
#>   5:              25     10.1              26 2024-06-05 1005.5          25      29.8               42
#>  ---                                                                                                  
#> 882:              25      2.6              26 2024-06-05 1023.5          25      10.3               42
#> 883:              25      1.5              26 2024-06-05 1018.0          25       5.2               42
#> 884:              25      2.1              26 2024-06-05 1019.6          25      12.3               42
#> 885:              25      2.1              26 2024-06-05 1019.0          25      12.4               42
#> 886:              75      2.4              26 2024-06-05 1019.7          25      13.0               25
#>      rainfall rainfall_source rh_tmax rh_tmax_source rh_tmin rh_tmin_source    vp vp_deficit
#>         <num>           <int>   <num>          <int>   <num>          <int> <num>      <num>
#>   1:     54.9              25    48.0             26    92.2             26  20.0       15.6
#>   2:      0.1              25    36.3             26   100.0             26  18.9       22.0
#>   3:      0.0              25    26.5             26    74.7             26  15.5       30.2
#>   4:      0.0              25    29.1             26    84.8             26  17.6       29.3
#>   5:      0.0              25    32.3             26    82.3             26  19.6       29.0
#>  ---                                                                                        
#> 882:      0.3              25    56.3             26   100.0             26  16.5        8.8
#> 883:      0.3              25    85.1             26    96.6             26  18.0        2.5
#> 884:      4.8              25    59.9             26   100.0             26  12.2        5.3
#> 885:      0.1              25    56.8             26   100.0             26  11.0        5.0
#> 886:      0.2              25    41.2             26   100.0             26  10.0        8.1
#>      vp_deficit_source vp_source
#>                  <int>     <int>
#>   1:                26        25
#>   2:                26        25
#>   3:                26        25
#>   4:                26        25
#>   5:                26        25
#>  ---                            
#> 882:                26        25
#> 883:                26        25
#> 884:                26        25
#> 885:                26        25
#> 886:                26        25
```

### Example 2: Get Data Drill Temperature for a Specific Date Range

Using coordinates for Southwood, Qld, get Data Drill temperature data for January of 2023.


``` r
library(weatherOz)

(
  southwood_temp <- get_data_drill(
    latitude = -27.85,
    longitude = 150.05,
    start_date = "20230101",
    end_date = "20230131",
    values = c("max_temp", "min_temp"),
    api_key = Sys.getenv("SILO_API_KEY")
  )
)
#>     longitude latitude  year month   day       date air_tmax air_tmax_source air_tmin air_tmin_source
#>         <num>    <num> <num> <num> <int>     <Date>    <num>           <int>    <num>           <int>
#>  1:    150.05   -27.85  2023     1     1 2023-01-01     35.2              25     19.5              25
#>  2:    150.05   -27.85  2023     1     2 2023-01-02     35.3              25     19.6              25
#>  3:    150.05   -27.85  2023     1     3 2023-01-03     36.6              25     20.6              25
#>  4:    150.05   -27.85  2023     1     4 2023-01-04     39.1              25     20.9              25
#>  5:    150.05   -27.85  2023     1     5 2023-01-05     31.4              25     21.4              25
#>  6:    150.05   -27.85  2023     1     6 2023-01-06     34.4              25     16.4              25
#>  7:    150.05   -27.85  2023     1     7 2023-01-07     33.4              25     19.8              25
#>  8:    150.05   -27.85  2023     1     8 2023-01-08     35.8              25     18.4              25
#>  9:    150.05   -27.85  2023     1     9 2023-01-09     36.4              25     20.7              25
#> 10:    150.05   -27.85  2023     1    10 2023-01-10     38.0              25     21.9              25
#> 11:    150.05   -27.85  2023     1    11 2023-01-11     33.3              25     21.4              25
#> 12:    150.05   -27.85  2023     1    12 2023-01-12     34.2              25     20.8              25
#> 13:    150.05   -27.85  2023     1    13 2023-01-13     33.6              25     18.3              25
#> 14:    150.05   -27.85  2023     1    14 2023-01-14     32.2              25     18.6              25
#> 15:    150.05   -27.85  2023     1    15 2023-01-15     34.2              25     19.0              25
#> 16:    150.05   -27.85  2023     1    16 2023-01-16     33.7              25     19.7              25
#> 17:    150.05   -27.85  2023     1    17 2023-01-17     34.8              25     18.5              25
#> 18:    150.05   -27.85  2023     1    18 2023-01-18     34.4              25     18.1              25
#> 19:    150.05   -27.85  2023     1    19 2023-01-19     35.0              25     18.7              25
#> 20:    150.05   -27.85  2023     1    20 2023-01-20     33.4              25     20.6              25
#> 21:    150.05   -27.85  2023     1    21 2023-01-21     33.6              25     17.7              25
#> 22:    150.05   -27.85  2023     1    22 2023-01-22     33.3              25     20.0              25
#> 23:    150.05   -27.85  2023     1    23 2023-01-23     34.6              25     20.3              25
#> 24:    150.05   -27.85  2023     1    24 2023-01-24     35.1              25     20.4              25
#> 25:    150.05   -27.85  2023     1    25 2023-01-25     38.1              25     20.2              25
#> 26:    150.05   -27.85  2023     1    26 2023-01-26     38.7              25     21.3              25
#> 27:    150.05   -27.85  2023     1    27 2023-01-27     34.3              25     23.1              25
#> 28:    150.05   -27.85  2023     1    28 2023-01-28     36.7              25     18.5              25
#> 29:    150.05   -27.85  2023     1    29 2023-01-29     37.7              25     21.6              25
#> 30:    150.05   -27.85  2023     1    30 2023-01-30     37.1              25     24.7              25
#> 31:    150.05   -27.85  2023     1    31 2023-01-31     31.6              25     21.9              25
#>     longitude latitude  year month   day       date air_tmax air_tmax_source air_tmin air_tmin_source
#>      elev_m  extracted
#>      <char>     <Date>
#>  1: 254.5 m 2024-06-05
#>  2: 254.5 m 2024-06-05
#>  3: 254.5 m 2024-06-05
#>  4: 254.5 m 2024-06-05
#>  5: 254.5 m 2024-06-05
#>  6: 254.5 m 2024-06-05
#>  7: 254.5 m 2024-06-05
#>  8: 254.5 m 2024-06-05
#>  9: 254.5 m 2024-06-05
#> 10: 254.5 m 2024-06-05
#> 11: 254.5 m 2024-06-05
#> 12: 254.5 m 2024-06-05
#> 13: 254.5 m 2024-06-05
#> 14: 254.5 m 2024-06-05
#> 15: 254.5 m 2024-06-05
#> 16: 254.5 m 2024-06-05
#> 17: 254.5 m 2024-06-05
#> 18: 254.5 m 2024-06-05
#> 19: 254.5 m 2024-06-05
#> 20: 254.5 m 2024-06-05
#> 21: 254.5 m 2024-06-05
#> 22: 254.5 m 2024-06-05
#> 23: 254.5 m 2024-06-05
#> 24: 254.5 m 2024-06-05
#> 25: 254.5 m 2024-06-05
#> 26: 254.5 m 2024-06-05
#> 27: 254.5 m 2024-06-05
#> 28: 254.5 m 2024-06-05
#> 29: 254.5 m 2024-06-05
#> 30: 254.5 m 2024-06-05
#> 31: 254.5 m 2024-06-05
#>      elev_m  extracted
```

### Example 3: Get Data Drill APSIM-ready Data

For APSIM users, SILO provides an endpoint that serves APSIM formatted data ready for use in this modelling framework.
The `get_data_drill_apsim()` function works just as `get_data_drill()`, it just returns an object that is an {[apsimx]} `met` class rather than a `data.table` and there is no need to specify values as those are predetermined by the API endpoint.
The [write_apsim_met()] function is reexported from [{apsimx}](https://cran.r-project.org/package=apsimx) for convenience in saving .met files.


``` r
library(weatherOz)

(
  southwood_apsim <- get_data_drill_apsim(
    latitude = -27.85,
    longitude = 150.05,
    start_date = "20230101",
    end_date = "20231231",
    api_key = Sys.getenv("SILO_API_KEY")
  )
)
#> weather.met.weather 
#> site =  
#> latitude = -27.85  (DECIMAL DEGREES) 
#> longitude = 150.05  (DECIMAL DEGREES) 
#> tav = 20.8006868131868 (oC) ! calculated annual average ambient temperature 2024-06-05 17:57:58.240289 
#> amp = 14.85 !calculated with the apsimx R package: 2024-06-05 17:57:58.24858 
#> year day radn maxt mint rain evap vp code 
#> () () (MJ/m^2) (oC) (oC) (mm) (mm) (hPa) () 
#>   year day radn maxt mint rain evap   vp   code
#> 1 2023   2 30.4 35.3 19.6  0.0  8.2 17.0 422222
#> 2 2023   3 22.7 36.6 20.6  0.0  6.1 18.2 422222
#> 3 2023   4 22.0 39.1 20.9  0.0  8.5 21.0 422222
#> 4 2023   5 12.1 31.4 21.4  3.6  6.5 18.1 422222
#> 5 2023   6 30.1 34.4 16.4  0.0  6.7 17.1 422222
#> 6 2023   7 27.6 33.4 19.8  0.0  5.7 15.7 422222
```

## Getting Patched Point Data

Patched Point data are derived from actual BOM station observations (PatchedPoint) data and may or may not be interpolated.
Be sure to note the `data_source` column to be sure.
The functions, `get_patched_point()` and `get_patched_point_apsim()` work exactly as their Data Drill counterparts except that they require a station code, `station_code`, rather than longitude and latitude values for the geographic location.

### Example 4: Get Data Drill Data Using Defaults

Using the station code for Wongan Hills, WA, get all values for June of 2021.


``` r
library(weatherOz)

(
  wongan_hills <- get_patched_point(
    station_code = "008137",
    start_date = "20210601",
    end_date = "20210630",
    api_key = Sys.getenv("SILO_API_KEY")
  )
)
#> You have requested station observation data but some rows in this
#> dataset have data codes for interpolated data.
#> Check the 'data_source' columns and `get_patched_point()` or
#> `get_data_drill()` documentation for further details on codes and
#> references.
#>     station_code station_name  year month   day       date air_tmax air_tmax_source air_tmin
#>           <fctr>       <char> <num> <num> <int>     <Date>    <num>           <int>    <num>
#>  1:       008137 Wongan Hills  2021     6     1 2021-06-01     15.0               0      5.5
#>  2:       008137 Wongan Hills  2021     6     2 2021-06-02     17.4               0      5.1
#>  3:       008137 Wongan Hills  2021     6     3 2021-06-03     18.6               0      5.9
#>  4:       008137 Wongan Hills  2021     6     4 2021-06-04     20.3               0      4.8
#>  5:       008137 Wongan Hills  2021     6     5 2021-06-05     20.5               0      4.6
#>  6:       008137 Wongan Hills  2021     6     6 2021-06-06     20.5              25      4.6
#>  7:       008137 Wongan Hills  2021     6     7 2021-06-07     15.8              25      5.4
#>  8:       008137 Wongan Hills  2021     6     8 2021-06-08     16.3               0      4.8
#>  9:       008137 Wongan Hills  2021     6     9 2021-06-09     18.2               0      7.2
#> 10:       008137 Wongan Hills  2021     6    10 2021-06-10     17.9               0      9.9
#> 11:       008137 Wongan Hills  2021     6    11 2021-06-11     18.5               0      9.8
#> 12:       008137 Wongan Hills  2021     6    12 2021-06-12     18.5               0     11.3
#> 13:       008137 Wongan Hills  2021     6    13 2021-06-13     19.2               0      6.7
#> 14:       008137 Wongan Hills  2021     6    14 2021-06-14     17.7               0      9.5
#> 15:       008137 Wongan Hills  2021     6    15 2021-06-15     15.1               0      5.2
#> 16:       008137 Wongan Hills  2021     6    16 2021-06-16     17.4               0      5.2
#> 17:       008137 Wongan Hills  2021     6    17 2021-06-17     16.0               0      4.9
#> 18:       008137 Wongan Hills  2021     6    18 2021-06-18     17.3               0      3.5
#> 19:       008137 Wongan Hills  2021     6    19 2021-06-19     17.7               0      3.4
#> 20:       008137 Wongan Hills  2021     6    20 2021-06-20     12.1               0      6.0
#> 21:       008137 Wongan Hills  2021     6    21 2021-06-21     11.5               0      6.9
#> 22:       008137 Wongan Hills  2021     6    22 2021-06-22     13.5               0      1.9
#> 23:       008137 Wongan Hills  2021     6    23 2021-06-23     14.1               0      3.4
#> 24:       008137 Wongan Hills  2021     6    24 2021-06-24     14.7               0      2.8
#> 25:       008137 Wongan Hills  2021     6    25 2021-06-25     16.4               0      2.1
#> 26:       008137 Wongan Hills  2021     6    26 2021-06-26     17.7              25      1.7
#> 27:       008137 Wongan Hills  2021     6    27 2021-06-27     15.7              25      4.2
#> 28:       008137 Wongan Hills  2021     6    28 2021-06-28     18.5               0      9.1
#> 29:       008137 Wongan Hills  2021     6    29 2021-06-29     15.6               0     10.6
#> 30:       008137 Wongan Hills  2021     6    30 2021-06-30     14.2               0      4.0
#>     station_code station_name  year month   day       date air_tmax air_tmax_source air_tmin
#>     air_tmin_source  elev_m et_morton_actual et_morton_actual_source et_morton_potential
#>               <int>  <char>            <num>                   <int>               <num>
#>  1:               0 283.0 m              1.0                      26                 1.0
#>  2:               0 283.0 m              1.7                      26                 1.9
#>  3:               0 283.0 m              1.2                      26                 2.5
#>  4:               0 283.0 m              1.1                      26                 2.8
#>  5:               0 283.0 m              1.2                      26                 2.6
#>  6:               0 283.0 m              1.4                      26                 2.4
#>  7:              25 283.0 m              1.5                      26                 1.9
#>  8:              25 283.0 m              0.6                      26                 2.4
#>  9:               0 283.0 m              0.2                      26                 1.7
#> 10:               0 283.0 m              1.0                      26                 1.0
#> 11:               0 283.0 m              1.9                      26                 1.9
#> 12:               0 283.0 m              1.5                      26                 2.0
#> 13:               0 283.0 m              1.1                      26                 2.4
#> 14:              25 283.0 m              1.4                      26                 1.4
#> 15:               0 283.0 m              1.1                      26                 1.2
#> 16:               0 283.0 m              0.9                      26                 1.9
#> 17:               0 283.0 m              1.1                      26                 1.5
#> 18:               0 283.0 m              1.2                      26                 2.3
#> 19:               0 283.0 m              0.6                      26                 2.8
#> 20:               0 283.0 m              0.9                      26                 0.9
#> 21:               0 283.0 m              0.9                      26                 1.2
#> 22:               0 283.0 m              1.0                      26                 2.1
#> 23:               0 283.0 m              1.1                      26                 1.9
#> 24:               0 283.0 m              0.8                      26                 2.5
#> 25:               0 283.0 m              1.3                      26                 2.0
#> 26:               0 283.0 m              0.8                      26                 2.6
#> 27:              25 283.0 m              0.4                      26                 1.4
#> 28:              25 283.0 m              1.4                      26                 1.7
#> 29:               0 283.0 m              1.5                      26                 1.5
#> 30:               0 283.0 m              1.1                      26                 1.1
#>     air_tmin_source  elev_m et_morton_actual et_morton_actual_source et_morton_potential
#>     et_morton_potential_source et_morton_wet et_morton_wet_source et_short_crop et_short_crop_source
#>                          <int>         <num>                <int>         <num>                <int>
#>  1:                         26           1.0                   26           1.0                   26
#>  2:                         26           1.8                   26           1.4                   26
#>  3:                         26           1.9                   26           1.7                   26
#>  4:                         26           1.9                   26           1.9                   26
#>  5:                         26           1.9                   26           1.9                   26
#>  6:                         26           1.9                   26           1.8                   26
#>  7:                         26           1.7                   26           1.3                   26
#>  8:                         26           1.5                   26           1.7                   26
#>  9:                         26           0.9                   26           2.0                   26
#> 10:                         26           1.0                   26           0.7                   26
#> 11:                         26           1.9                   26           1.3                   26
#> 12:                         26           1.8                   26           1.4                   26
#> 13:                         26           1.8                   26           1.6                   26
#> 14:                         26           1.4                   26           1.1                   26
#> 15:                         26           1.2                   26           1.1                   26
#> 16:                         26           1.4                   26           1.4                   26
#> 17:                         26           1.3                   26           1.2                   26
#> 18:                         26           1.7                   26           1.5                   26
#> 19:                         26           1.7                   26           1.8                   26
#> 20:                         26           0.9                   26           0.8                   26
#> 21:                         26           1.0                   26           1.0                   26
#> 22:                         26           1.6                   26           1.3                   26
#> 23:                         26           1.5                   26           1.3                   26
#> 24:                         26           1.6                   26           1.5                   26
#> 25:                         26           1.7                   26           1.4                   26
#> 26:                         26           1.7                   26           1.7                   26
#> 27:                         26           0.9                   26           1.7                   26
#> 28:                         26           1.6                   26           1.3                   26
#> 29:                         26           1.5                   26           0.9                   26
#> 30:                         26           1.1                   26           1.0                   26
#>     et_morton_potential_source et_morton_wet et_morton_wet_source et_short_crop et_short_crop_source
#>     et_tall_crop et_tall_crop_source evap_comb evap_comb_source evap_morton_lake
#>            <num>               <int>     <num>            <int>            <num>
#>  1:          1.2                  26       1.7               25              1.0
#>  2:          1.8                  26       1.3               25              1.8
#>  3:          2.3                  26       1.6               25              1.9
#>  4:          2.7                  26       1.9               25              1.9
#>  5:          2.6                  26       2.4               25              1.9
#>  6:          2.4                  26       1.4               25              1.9
#>  7:          1.7                  26       2.6               25              1.7
#>  8:          2.4                  26       3.4               25              1.5
#>  9:          3.1                  26       2.2               25              1.0
#> 10:          0.7                  26       1.0               25              0.9
#> 11:          1.6                  26       1.2               25              1.9
#> 12:          1.8                  26       1.6               25              1.8
#> 13:          2.3                  26       2.3               25              1.8
#> 14:          1.3                  26       2.5               25              1.4
#> 15:          1.4                  26       1.3               25              1.2
#> 16:          2.0                  26       1.8               25              1.4
#> 17:          1.6                  26       2.5               25              1.3
#> 18:          2.1                  26       1.9               25              1.7
#> 19:          2.6                  26       1.6               25              1.7
#> 20:          1.0                  26       1.6               25              0.9
#> 21:          1.2                  26       2.1               25              1.0
#> 22:          1.9                  26       1.2               25              1.6
#> 23:          1.7                  26       1.0               25              1.5
#> 24:          2.2                  26       1.6               25              1.6
#> 25:          2.0                  26       1.7               25              1.7
#> 26:          2.5                  26       2.7               25              1.7
#> 27:          2.5                  26       1.5               25              0.9
#> 28:          1.7                  26       2.6               25              1.6
#> 29:          1.1                  26       2.1               25              1.5
#> 30:          1.2                  26       2.5               25              1.1
#>     et_tall_crop et_tall_crop_source evap_comb evap_comb_source evap_morton_lake
#>     evap_morton_lake_source evap_pan evap_pan_source evap_syn evap_syn_source  extracted latitude
#>                       <int>    <num>           <int>    <num>           <int>     <Date>    <num>
#>  1:                      26      1.7              25      1.7              26 2024-06-05 -30.8917
#>  2:                      26      1.3              25      2.0              26 2024-06-05 -30.8917
#>  3:                      26      1.6              25      2.2              26 2024-06-05 -30.8917
#>  4:                      26      1.9              25      2.5              26 2024-06-05 -30.8917
#>  5:                      26      2.4              25      2.4              26 2024-06-05 -30.8917
#>  6:                      26      1.4              25      2.4              26 2024-06-05 -30.8917
#>  7:                      26      2.6              25      2.0              26 2024-06-05 -30.8917
#>  8:                      26      3.4              25      2.2              26 2024-06-05 -30.8917
#>  9:                      26      2.2              25      2.5              26 2024-06-05 -30.8917
#> 10:                      26      1.0              25      1.5              26 2024-06-05 -30.8917
#> 11:                      26      1.2              25      1.9              26 2024-06-05 -30.8917
#> 12:                      26      1.6              25      1.9              26 2024-06-05 -30.8917
#> 13:                      26      2.3              25      2.2              26 2024-06-05 -30.8917
#> 14:                      26      2.5              25      1.8              26 2024-06-05 -30.8917
#> 15:                      26      1.3              25      1.8              26 2024-06-05 -30.8917
#> 16:                      26      1.8              25      2.1              26 2024-06-05 -30.8917
#> 17:                      26      2.5              25      1.9              26 2024-06-05 -30.8917
#> 18:                      26      1.9              25      2.2              26 2024-06-05 -30.8917
#> 19:                      26      1.6              25      2.3              26 2024-06-05 -30.8917
#> 20:                      26      1.6              25      1.6              26 2024-06-05 -30.8917
#> 21:                      26      2.1              25      1.7              26 2024-06-05 -30.8917
#> 22:                      26      1.2              25      2.0              26 2024-06-05 -30.8917
#> 23:                      26      1.0              25      2.0              26 2024-06-05 -30.8917
#> 24:                      26      1.6              25      2.1              26 2024-06-05 -30.8917
#> 25:                      26      1.7              25      2.1              26 2024-06-05 -30.8917
#> 26:                      26      2.7              25      2.4              26 2024-06-05 -30.8917
#> 27:                      26      1.5              25      2.2              26 2024-06-05 -30.8917
#> 28:                      26      2.6              25      2.0              26 2024-06-05 -30.8917
#> 29:                      26      2.1              25      1.6              26 2024-06-05 -30.8917
#> 30:                      26      2.5              25      1.8              26 2024-06-05 -30.8917
#>     evap_morton_lake_source evap_pan evap_pan_source evap_syn evap_syn_source  extracted latitude
#>     longitude   mslp mslp_source radiation radiation_source rainfall rainfall_source rh_tmax
#>         <num>  <num>       <int>     <num>            <int>    <num>           <int>   <num>
#>  1:  116.7186 1022.6           0       8.9               42      0.0               0    68.1
#>  2:  116.7186 1026.5           0      12.4               42      0.0               0    57.9
#>  3:  116.7186 1028.6           0      12.5               42      0.0               0    50.9
#>  4:  116.7186 1027.2           0      12.7               42      0.0               0    44.9
#>  5:  116.7186 1023.8           0      12.6               42      0.0               0    45.6
#>  6:  116.7186 1020.1           0      12.6               42      0.0               0    48.1
#>  7:  116.7186 1027.6          25      12.3               42      0.0               0    59.6
#>  8:  116.7186 1026.9           0      11.0               42      0.0               0    47.0
#>  9:  116.7186 1015.0           0       7.1               42      0.0               0    39.3
#> 10:  116.7186 1010.2           0       6.8               42      1.2               0    81.5
#> 11:  116.7186 1013.8           0      12.0               42      3.4               0    68.1
#> 12:  116.7186 1014.6           0      11.3               42      2.4               0    67.7
#> 13:  116.7186 1019.5           0      12.0               42      0.2               0    52.2
#> 14:  116.7186 1018.0           0       9.4               42      0.4               0    70.6
#> 15:  116.7186 1021.5           0       9.2               42      0.0               0    63.5
#> 16:  116.7186 1026.8           0      10.3               42      0.2               0    53.9
#> 17:  116.7186 1031.7           0       9.9               42      0.0               0    58.9
#> 18:  116.7186 1030.1           0      12.3               42      0.0               0    49.7
#> 19:  116.7186 1024.9           0      12.2               42      0.0               0    43.5
#> 20:  116.7186 1016.4           0       4.6               42      0.0               0    73.0
#> 21:  116.7186 1012.3           0       8.3               42     16.4               0    73.7
#> 22:  116.7186 1022.6           0      12.1               42      0.4               0    51.7
#> 23:  116.7186 1026.7           0      11.3               42      0.0               0    56.0
#> 24:  116.7186 1029.7           0      12.2               42      0.0               0    47.9
#> 25:  116.7186 1027.6           0      12.4               42      0.0               0    50.4
#> 26:  116.7186 1024.8           0      12.4               42      0.0               0    42.0
#> 27:  116.7186 1014.1          25       7.2               42      0.0               0    43.8
#> 28:  116.7186 1013.9           0      10.6               42      1.8               0    63.9
#> 29:  116.7186 1016.7           0       6.8               42      3.8               0    79.0
#> 30:  116.7186 1026.5           0       9.2               42      2.6               0    65.5
#>     longitude   mslp mslp_source radiation radiation_source rainfall rainfall_source rh_tmax
#>     rh_tmax_source rh_tmin rh_tmin_source    vp vp_deficit vp_deficit_source vp_source
#>              <int>   <num>          <int> <num>      <num>             <int>     <int>
#>  1:             26   100.0             26  11.6        3.0                26         0
#>  2:             26   100.0             26  11.5        4.8                26         0
#>  3:             26   100.0             26  10.9        6.6                26         0
#>  4:             26   100.0             26  10.7        8.0                26         0
#>  5:             26   100.0             26  11.0        7.8                26         0
#>  6:             26   100.0             26  11.6        7.2                26         0
#>  7:             26   100.0             26  10.7        4.5                26        25
#>  8:             26   100.0             26   8.7        6.7                26         0
#>  9:             26    80.8             26   8.2        9.3                26         0
#> 10:             26   100.0             26  16.7        1.4                26         0
#> 11:             26   100.0             26  14.5        4.1                26         0
#> 12:             26   100.0             26  14.4        4.6                26         0
#> 13:             26   100.0             26  11.6        6.7                26         0
#> 14:             26   100.0             26  14.3        3.5                26         0
#> 15:             26   100.0             26  10.9        3.7                26         0
#> 16:             26   100.0             26  10.7        5.6                26         0
#> 17:             26   100.0             26  10.7        4.5                26         0
#> 18:             26   100.0             26   9.8        6.0                26         0
#> 19:             26   100.0             26   8.8        7.3                26         0
#> 20:             26   100.0             26  10.3        2.5                26         0
#> 21:             26   100.0             26  10.0        2.6                26         0
#> 22:             26   100.0             26   8.0        4.8                26         0
#> 23:             26   100.0             26   9.0        4.5                26         0
#> 24:             26   100.0             26   8.0        5.8                26         0
#> 25:             26   100.0             26   9.4        5.4                26         0
#> 26:             26   100.0             26   8.5        7.2                26         0
#> 27:             26    94.6             26   7.8        7.0                26        25
#> 28:             26   100.0             26  13.6        4.7                26         0
#> 29:             26   100.0             26  14.0        2.3                26         0
#> 30:             26   100.0             26  10.6        3.1                26         0
#>     rh_tmax_source rh_tmin rh_tmin_source    vp vp_deficit vp_deficit_source vp_source
```

## Working With SILO Metadata

Two functions are provided to assist in fetching metadata about the stations.
 * `find_nearby_stations()`, which returns a `data.table` with the nearest weather stations to a given geographic point or known station either in the DPIRD or BOM (from SILO) networks.
 * `get_stations_metadata()`, which returns a `data.table` with the latest and most up-to-date information available from the Weather 2.0 API on the stations' geographic locations, hardware details, *e.g.,* wind mast height, and recording capabilities.

### Finding Nearby Stations

Functions for searching metadata in the SILO network do not require an API key except where you may also interact with the DPIRD API.

### Example 5: Finding Stations Nearby a Known Station

Query stations and return BOM's stations nearest to the DPIRD Northam, WA station, "NO", returning stations with 50 km of this station.
This requires a DPIRD API key as we're using that station as the starting point.


``` r
library(weatherOz)

(
  wa_stn <- find_nearby_stations(
    station_code = "010111",
    distance_km = 50,
    which_api = "silo"
  )
)
#>     station_code     station_name longitude latitude  state elev_m  owner distance_km
#>           <fctr>           <char>     <num>    <num> <char>  <num> <char>       <num>
#>  1:       010111          Northam  116.6586 -31.6508     WA    170    BOM         0.0
#>  2:       010152 Muresk Institute  116.6833 -31.7500     WA    166    BOM        10.2
#>  3:       010150     Grass Valley  116.7969 -31.6358     WA    200    BOM        13.9
#>  4:       010125          Toodyay  116.4703 -31.5517     WA    140    BOM        21.3
#>  5:       010244      Bakers Hill  116.4561 -31.7469     WA    330    BOM        22.4
#>  6:       010115      Quellington  116.8647 -31.7714     WA    220    BOM        23.9
#>  7:       010311             York  116.7650 -31.8997     WA    179    BOM        27.1
#>  8:       010023   Warradong Farm  116.9411 -31.5003     WA    240    BOM        32.0
#>  9:       010091        Meckering  117.0081 -31.6322     WA    195    BOM        35.0
#> 10:       010138         Wooroloo  116.3413 -31.8150     WA    277    BOM        35.7
#> 11:       010134        Wattening  116.5150 -31.3119     WA    240    BOM        36.8
#> 12:       010058       Goomalling  116.8269 -31.2994     WA    239    BOM        39.0
#> 13:       010009          Bolgart  116.5092 -31.2744     WA    240    BOM        40.5
#> 14:       010165      Green Hills  116.9839 -31.9408     WA    244    BOM        43.6
#> 15:       009007          Chidlow  116.2658 -31.8622     WA    300    BOM        44.6
#> 16:       009066      Gidgegannup  116.1976 -31.7906     WA    290    BOM        48.2
#> 17:       010163           Jaroma  117.1433 -31.7706     WA    265    BOM        49.9
#> 18:       010160      Quella Park  117.1194 -31.4533     WA    265    BOM        50.1
#> 19:       010120     Doodenanning  117.0986 -31.9092     WA    290    BOM        51.0
#> 20:       010795    Avondale Farm  116.8678 -32.1178     WA    200    BOM        51.2
#> 21:       010515         Beverley  116.9247 -32.1083     WA    199    BOM        52.9
#> 22:       009031   Mundaring Weir  116.1642 -31.9564     WA    190    BOM        58.1
#> 23:       010042          Dowerin  117.0311 -31.1936     WA    273    BOM        59.0
#> 24:       010000      Amery Acres  117.0736 -31.1683     WA    340    BOM        63.6
#>     station_code     station_name longitude latitude  state elev_m  owner distance_km
```

### Example 6: Finding Stations Nearby a Given Longitude and Latitude

Using the longitude and latitude for Northam, WA, find only BOM stations within a 50km radius of this geographic point.


``` r
library(weatherOz)

(
  wa_stn_lonlat <- find_nearby_stations(
    longitude = 116.6620,
    latitude = -31.6540,
    distance_km = 50,
    which_api = "silo"
  )
)
#>     station_code     station_name longitude latitude  state elev_m  owner distance_km
#>           <fctr>           <char>     <num>    <num> <char>  <num> <char>       <num>
#>  1:       010111          Northam  116.6586 -31.6508     WA    170    BOM    0.479696
#>  2:       010152 Muresk Institute  116.6833 -31.7500     WA    166    BOM   10.861214
#>  3:       010150     Grass Valley  116.7969 -31.6358     WA    200    BOM   12.927642
#>  4:       010125          Toodyay  116.4703 -31.5517     WA    140    BOM   21.421152
#>  5:       010244      Bakers Hill  116.4561 -31.7469     WA    330    BOM   22.045764
#>  6:       010115      Quellington  116.8647 -31.7714     WA    220    BOM   23.192674
#>  7:       010311             York  116.7650 -31.8997     WA    179    BOM   28.998370
#>  8:       010023   Warradong Farm  116.9411 -31.5003     WA    240    BOM   31.477722
#>  9:       010091        Meckering  117.0081 -31.6322     WA    195    BOM   32.848599
#> 10:       010138         Wooroloo  116.3413 -31.8150     WA    277    BOM   35.213369
#> 11:       010134        Wattening  116.5150 -31.3119     WA    240    BOM   40.506038
#> 12:       010058       Goomalling  116.8269 -31.2994     WA    239    BOM   42.409889
#> 13:       009007          Chidlow  116.2658 -31.8622     WA    300    BOM   44.029617
#> 14:       010165      Green Hills  116.9839 -31.9408     WA    244    BOM   44.066701
#> 15:       010009          Bolgart  116.5092 -31.2744     WA    240    BOM   44.620097
#> 16:       009066      Gidgegannup  116.1976 -31.7906     WA    290    BOM   46.470370
#> 17:       010163           Jaroma  117.1433 -31.7706     WA    265    BOM   47.331752
#> 18:       010160      Quella Park  117.1194 -31.4533     WA    265    BOM   48.742243
```

### Example 7: Finding Stations in Both the DPIRD and SILO Data Sets

Query stations nearest BOM's Northam, WA station, "010111" and return both DPIRD and SILO/BOM stations within 50 km of this station.
Note the use of an API key for the DPIRD network and that `which_api` is set to "all".


``` r
library(weatherOz)

(
  wa_stn_all <- find_nearby_stations(
    station_code = "010111",
    distance_km = 50,
    api_key = Sys.getenv("DPIRD_API_KEY"),
    which_api = "all"
  )
)
#>     station_code       station_name longitude  latitude  state elev_m
#>           <fctr>             <char>     <num>     <num> <char>  <num>
#>  1:       010111            Northam  116.6586 -31.65080     WA    170
#>  2:           NO            Northam  116.6942 -31.65161     WA    163
#>  3:           MK             Muresk  116.6913 -31.72772     WA    251
#>  4:       010152   Muresk Institute  116.6833 -31.75000     WA    166
#>  5:       010150       Grass Valley  116.7969 -31.63580     WA    200
#>  6:       010125            Toodyay  116.4703 -31.55170     WA    140
#>  7:       010244        Bakers Hill  116.4561 -31.74690     WA    330
#>  8:       010115        Quellington  116.8647 -31.77140     WA    220
#>  9:       010311               York  116.7650 -31.89970     WA    179
#> 10:         BTSB DFES-B Talbot West  116.6898 -31.96060     WA    357
#> 11:       010023     Warradong Farm  116.9411 -31.50030     WA    240
#> 12:        YE001          York East  116.9211 -31.83588     WA    229
#> 13:         ROGR      Rolling Green  116.3184 -31.69527     WA    315
#> 14:       010091          Meckering  117.0081 -31.63220     WA    195
#> 15:       010138           Wooroloo  116.3413 -31.81500     WA    277
#> 16:       010134          Wattening  116.5150 -31.31190     WA    240
#> 17:       010058         Goomalling  116.8269 -31.29940     WA    239
#> 18:       010009            Bolgart  116.5092 -31.27440     WA    240
#> 19:       010165        Green Hills  116.9839 -31.94080     WA    244
#> 20:         BCAA    DBCA-A Portable  116.2560 -31.84210     WA    264
#> 21:       009007            Chidlow  116.2658 -31.86220     WA    300
#> 22:       009066        Gidgegannup  116.1976 -31.79060     WA    290
#> 23:       010163             Jaroma  117.1433 -31.77060     WA    265
#> 24:       010160        Quella Park  117.1194 -31.45330     WA    265
#> 25:       010120       Doodenanning  117.0986 -31.90920     WA    290
#> 26:       010795      Avondale Farm  116.8678 -32.11780     WA    200
#> 27:       010515           Beverley  116.9247 -32.10830     WA    199
#> 28:       009031     Mundaring Weir  116.1642 -31.95640     WA    190
#> 29:       010042            Dowerin  117.0311 -31.19360     WA    273
#> 30:       010000        Amery Acres  117.0736 -31.16830     WA    340
#>     station_code       station_name longitude  latitude  state elev_m
#>                                                                    owner distance_km
#>                                                                   <char>       <num>
#>  1:                                                                  BOM        0.00
#>  2: WA Department of Primary Industries and Regional Development (DPIRD)        3.56
#>  3: WA Department of Primary Industries and Regional Development (DPIRD)        8.36
#>  4:                                                                  BOM       10.20
#>  5:                                                                  BOM       13.90
#>  6:                                                                  BOM       21.30
#>  7:                                                                  BOM       22.40
#>  8:                                                                  BOM       23.90
#>  9:                                                                  BOM       27.10
#> 10:                  WA Department of Fire and Emergency Services (DFES)       31.14
#> 11:                                                                  BOM       32.00
#> 12: WA Department of Primary Industries and Regional Development (DPIRD)       32.12
#> 13:   WA Department of Biodiversity, Conservation and Attractions (DBCA)       34.31
#> 14:                                                                  BOM       35.00
#> 15:                                                                  BOM       35.70
#> 16:                                                                  BOM       36.80
#> 17:                                                                  BOM       39.00
#> 18:                                                                  BOM       40.50
#> 19:                                                                  BOM       43.60
#> 20:   WA Department of Biodiversity, Conservation and Attractions (DBCA)       44.57
#> 21:                                                                  BOM       44.60
#> 22:                                                                  BOM       48.20
#> 23:                                                                  BOM       49.90
#> 24:                                                                  BOM       50.10
#> 25:                                                                  BOM       51.00
#> 26:                                                                  BOM       51.20
#> 27:                                                                  BOM       52.90
#> 28:                                                                  BOM       58.10
#> 29:                                                                  BOM       59.00
#> 30:                                                                  BOM       63.60
#>                                                                    owner distance_km
```

### Example 8: Finding Stations in a Bounding Box for Melbourne

Using a (generous) bounding box for Melbourne, VIC using only the SILO API for BOM stations, no API key is needed.


``` r
bbox <- find_stations_in(
  x = c(144.470215, -38.160476, 145.612793, -37.622934),
  which_api = "SILO",
  include_closed = TRUE
)
bbox
#>      station_code                          station_name      start        end latitude longitude
#>            <fctr>                                <char>     <Date>     <Date>    <num>     <num>
#>   1:       087131 Altona City Offices Operations Centre 1967-01-01 2024-06-05 -37.8634  144.8262
#>   2:       086147                       Aspendale Csiro 1954-01-01 1985-01-01 -38.0333  145.1000
#>   3:       087113                        Avalon Airport 1965-01-01 2024-06-05 -38.0288  144.4783
#>   4:       086002                          Balwyn North 1922-01-01 1969-01-01 -37.8000  145.0500
#>   5:       086029                        Beaconsfield 2 1926-01-01 1975-01-01 -38.0000  145.4167
#>  ---                                                                                            
#> 106:       087066                  Werribee Post Office 1901-01-01 1966-01-01 -37.9000  144.6667
#> 107:       087150                   Werribee Racecourse 1958-01-01 2024-06-05 -37.9043  144.6427
#> 108:       087065                Werribee Research Farm 1913-01-01 1980-01-01 -37.9000  144.6833
#> 109:       086129                         Woori Yallock 1901-01-01 1986-01-01 -37.8000  145.5167
#> 110:       086132                Yarra River Yarra Glen 1890-01-01 1974-01-01 -37.6647  145.3761
#>       state elev_m                      source status   wmo
#>      <char>  <num>                      <char> <char> <num>
#>   1:    VIC    3.0 Bureau of Meteorology (BOM)   open    NA
#>   2:    VIC    5.0 Bureau of Meteorology (BOM) closed    NA
#>   3:    VIC   10.6 Bureau of Meteorology (BOM)   open 94854
#>   4:    VIC     NA Bureau of Meteorology (BOM) closed    NA
#>   5:    VIC  213.4 Bureau of Meteorology (BOM) closed    NA
#>  ---                                                       
#> 106:    VIC   23.5 Bureau of Meteorology (BOM) closed    NA
#> 107:    VIC   20.0 Bureau of Meteorology (BOM)   open    NA
#> 108:    VIC   24.0 Bureau of Meteorology (BOM) closed    NA
#> 109:    VIC   99.0 Bureau of Meteorology (BOM) closed    NA
#> 110:    VIC   88.0 Bureau of Meteorology (BOM) closed    NA
```

### Example 9: Finding the Station Nearest the Centroid of a Bounding Box

Using the same bounding box but only find a single open station nearest the centroid of the bounding box.
This will return a single value in this case as there is only one polygon.
For queries where the polygon has 'n' parts, 'n' results will be returned.


``` r
centroid <- find_stations_in(
  x = c(144.470215, -38.160476, 145.612793, -37.622934),
  which_api = "SILO",
  include_closed = FALSE,
  centroid = TRUE
)
centroid
#>    station_code         station_name      start        end latitude longitude  state elev_m
#>          <fctr>               <char>     <Date>     <Date>    <num>     <num> <char>  <num>
#> 1:       086018 Caulfield Racecourse 1887-01-01 2024-06-05 -37.8795  145.0368    VIC   48.8
#>                         source status   wmo
#>                         <char> <char> <num>
#> 1: Bureau of Meteorology (BOM)   open    NA
```

### Getting Station Metadata for the SILO Network Stations

The `get_stations_metadata()` function is shared with the DPIRD functions as well, so this function will retrieve data from both weather APIs.
Shown here is how to use it for SILO data only.

### Example 10: Get SILO Station Metadata

The `get_stations_metadata()` function allows you to get details about the stations themselves for stations in the DPIRD and SILO (BOM) networks in one function.
Here we demonstrate how to get the metadata for the SILO stations only.


``` r
library(weatherOz)

(metadata <- get_stations_metadata(which_api = "silo"))
#>       station_code                     station_name      start        end latitude longitude  state
#>             <fctr>                           <char>     <Date>     <Date>    <num>     <num> <char>
#>    1:       061065                Aberdeen Rossgole 1926-01-01 2024-06-05 -32.1402  150.7285    NSW
#>    2:       071000    Adaminaby Alpine Tourist Park 1886-01-01 2024-06-05 -35.9962  148.7693    NSW
#>    3:       068000          Albion Park Post Office 1892-01-01 2024-06-05 -34.5712  150.7761    NSW
#>    4:       068241 Albion Park Shellharbour Airport 1999-01-01 2024-06-05 -34.5639  150.7924    NSW
#>    5:       072146                   Albury Airport 1973-01-01 2024-06-05 -36.0694  146.9531    NSW
#>   ---                                                                                              
#> 3694:       007096                             Yuin 1898-01-01 2024-06-05 -27.9808  116.0347     WA
#> 3695:       012092                         Yuinmery 1921-01-01 2024-06-05 -28.5606  119.0161     WA
#> 3696:       002030                           Yulmbu 1950-01-01 2024-06-05 -17.2986  126.9158     WA
#> 3697:       008147                             Yuna 1909-01-01 2024-06-05 -28.3250  114.9589     WA
#> 3698:       012093                      Yundamindra 1901-01-01 2024-06-05 -29.2472  122.1022     WA
#>       elev_m                      source status   wmo
#>        <num>                      <char> <char> <num>
#>    1:    543 Bureau of Meteorology (BOM)   open    NA
#>    2:   1015 Bureau of Meteorology (BOM)   open    NA
#>    3:      8 Bureau of Meteorology (BOM)   open    NA
#>    4:      8 Bureau of Meteorology (BOM)   open 95748
#>    5:    165 Bureau of Meteorology (BOM)   open    NA
#>   ---                                                
#> 3694:    300 Bureau of Meteorology (BOM)   open    NA
#> 3695:    500 Bureau of Meteorology (BOM)   open    NA
#> 3696:    450 Bureau of Meteorology (BOM)   open    NA
#> 3697:    270 Bureau of Meteorology (BOM)   open    NA
#> 3698:    450 Bureau of Meteorology (BOM)   open    NA
```
### Using Metadata to Get Weather Data for a Whole State

Using the metadata, we can get all weather data from stations in a single state like so.


``` r
library(weatherOz)
library(data.table)
#> data.table 1.15.4 using 4 threads (see ?getDTthreads).  Latest news: r-datatable.com
#> 
#> Attaching package: 'data.table'
#> 
#> The following objects are masked from 'package:dplyr':
#> 
#>     between, first, last
```

``` r

metadata <- get_stations_metadata(which_api = "silo")

# Subset to the required state
metadata_wa <- subset(metadata, state == "WA")

# Select first 10 to demo
first_ten <- as.list(as.character(metadata_wa$station_code))[1:10]

# Loop through each station_code and give proper names
# We've wrapped it in `suppressMessages()` to keep the output a bit quieter
# as most of the data have interpolated values in them that will repeat for
# every set.

suppressMessages(
  x <-
    lapply(
      X = first_ten,
      FUN = get_patched_point,
      start_date = "20001201",
      end_date = "20001205",
      values = "all",
      api_key = Sys.getenv("SILO_API_KEY")
    )
)

names(x) <- unlist(first_ten)

# Create dataset with station_code column id
rbindlist(x, idcol = "station_code")
#>     station_code station_code     station_name  year month   day       date air_tmax air_tmax_source
#>           <char>       <fctr>           <char> <num> <num> <int>     <Date>    <num>           <int>
#>  1:       009804       009804            Adina  2000    12     1 2000-12-01     35.1              25
#>  2:       009804       009804            Adina  2000    12     2 2000-12-02     21.0              25
#>  3:       009804       009804            Adina  2000    12     3 2000-12-03     26.5              25
#>  4:       009804       009804            Adina  2000    12     4 2000-12-04     23.0              25
#>  5:       009804       009804            Adina  2000    12     5 2000-12-05     23.5              25
#>  6:       008000       008000            Ajana  2000    12     1 2000-12-01     32.6              25
#>  7:       008000       008000            Ajana  2000    12     2 2000-12-02     30.4              25
#>  8:       008000       008000            Ajana  2000    12     3 2000-12-03     35.6              25
#>  9:       008000       008000            Ajana  2000    12     4 2000-12-04     33.0              25
#> 10:       008000       008000            Ajana  2000    12     5 2000-12-05     33.4              25
#> 11:       009500       009500           Albany  2000    12     1 2000-12-01     24.3              25
#> 12:       009500       009500           Albany  2000    12     2 2000-12-02     19.8              25
#> 13:       009500       009500           Albany  2000    12     3 2000-12-03     28.9              25
#> 14:       009500       009500           Albany  2000    12     4 2000-12-04     18.0              25
#> 15:       009500       009500           Albany  2000    12     5 2000-12-05     21.3              25
#> 16:       012001       012001     Albion Downs  2000    12     1 2000-12-01     39.3              25
#> 17:       012001       012001     Albion Downs  2000    12     2 2000-12-02     35.3              25
#> 18:       012001       012001     Albion Downs  2000    12     3 2000-12-03     35.3              25
#> 19:       012001       012001     Albion Downs  2000    12     4 2000-12-04     40.2              25
#> 20:       012001       012001     Albion Downs  2000    12     5 2000-12-05     42.1              25
#> 21:       010052       010052           Aleppo  2000    12     1 2000-12-01     36.8              25
#> 22:       010052       010052           Aleppo  2000    12     2 2000-12-02     28.2              25
#> 23:       010052       010052           Aleppo  2000    12     3 2000-12-03     35.3              25
#> 24:       010052       010052           Aleppo  2000    12     4 2000-12-04     33.4              25
#> 25:       010052       010052           Aleppo  2000    12     5 2000-12-05     33.5              25
#> 26:       009801       009801 Alexandra Bridge  2000    12     1 2000-12-01     22.4              25
#> 27:       009801       009801 Alexandra Bridge  2000    12     2 2000-12-02     22.0              25
#> 28:       009801       009801 Alexandra Bridge  2000    12     3 2000-12-03     23.5              25
#> 29:       009801       009801 Alexandra Bridge  2000    12     4 2000-12-04     20.1              25
#> 30:       009801       009801 Alexandra Bridge  2000    12     5 2000-12-05     23.8              25
#> 31:       010894       010894      Allan Rocks  2000    12     1 2000-12-01     36.6              25
#> 32:       010894       010894      Allan Rocks  2000    12     2 2000-12-02     27.4              25
#> 33:       010894       010894      Allan Rocks  2000    12     3 2000-12-03     33.6              25
#> 34:       010894       010894      Allan Rocks  2000    12     4 2000-12-04     31.7              25
#> 35:       010894       010894      Allan Rocks  2000    12     5 2000-12-05     32.0              25
#> 36:       010502       010502           Amelup  2000    12     1 2000-12-01     31.7              25
#> 37:       010502       010502           Amelup  2000    12     2 2000-12-02     24.1              25
#> 38:       010502       010502           Amelup  2000    12     3 2000-12-03     30.9              25
#> 39:       010502       010502           Amelup  2000    12     4 2000-12-04     23.0              25
#> 40:       010502       010502           Amelup  2000    12     5 2000-12-05     24.3              25
#> 41:       010000       010000      Amery Acres  2000    12     1 2000-12-01     36.8              25
#> 42:       010000       010000      Amery Acres  2000    12     2 2000-12-02     28.3              25
#> 43:       010000       010000      Amery Acres  2000    12     3 2000-12-03     35.6              25
#> 44:       010000       010000      Amery Acres  2000    12     4 2000-12-04     33.4              25
#> 45:       010000       010000      Amery Acres  2000    12     5 2000-12-05     33.8              25
#> 46:       010696       010696     Amrista Park  2000    12     1 2000-12-01     36.0              25
#> 47:       010696       010696     Amrista Park  2000    12     2 2000-12-02     27.2              25
#> 48:       010696       010696     Amrista Park  2000    12     3 2000-12-03     33.4              25
#> 49:       010696       010696     Amrista Park  2000    12     4 2000-12-04     31.6              25
#> 50:       010696       010696     Amrista Park  2000    12     5 2000-12-05     31.7              25
#>     station_code station_code     station_name  year month   day       date air_tmax air_tmax_source
#>     air_tmin air_tmin_source  elev_m et_morton_actual et_morton_actual_source et_morton_potential
#>        <num>           <int>  <char>            <num>                   <int>               <num>
#>  1:     11.5              25  60.0 m              3.3                      26                11.2
#>  2:     15.3              25  60.0 m              5.5                      26                 8.9
#>  3:      8.5              25  60.0 m              4.8                      26                 9.4
#>  4:     13.0              25  60.0 m              5.6                      26                 6.8
#>  5:     15.2              25  60.0 m              3.9                      26                 7.6
#>  6:     14.6              25 210.0 m              4.3                      26                 9.6
#>  7:     15.6              25 210.0 m              2.7                      26                10.9
#>  8:     16.0              25 210.0 m              1.4                      26                12.6
#>  9:     16.8              25 210.0 m              1.9                      26                11.7
#> 10:     17.0              25 210.0 m              0.7                      26                 8.4
#> 11:      8.5              25   3.0 m              7.0                      26                 7.7
#> 12:     12.0              25   3.0 m              5.0                      26                 7.2
#> 13:      8.6              25   3.0 m              5.5                      26                 9.3
#> 14:     12.5              25   3.0 m              3.2                      26                 3.2
#> 15:     13.4              25   3.0 m              3.4                      26                 6.9
#> 16:     22.0              25 500.0 m              0.8                      26                14.3
#> 17:     21.9              25 500.0 m              1.1                      26                13.6
#> 18:     20.1              25 500.0 m              0.6                      26                13.9
#> 19:     22.9              25 500.0 m              0.2                      26                15.4
#> 20:     20.5              25 500.0 m              0.0                      26                14.4
#> 21:     11.7              25 300.0 m              2.0                      26                11.3
#> 22:     12.2              25 300.0 m              2.4                      26                 9.8
#> 23:     12.6              25 300.0 m              1.8                      26                11.3
#> 24:     14.0              25 300.0 m              2.8                      26                10.3
#> 25:     15.1              25 300.0 m              2.6                      26                10.4
#> 26:     11.4              25  20.0 m              6.7                      26                 6.9
#> 27:     12.2              25  20.0 m              5.2                      26                 8.8
#> 28:      8.0              25  20.0 m              6.7                      26                 7.4
#> 29:     13.5              25  20.0 m              3.5                      26                 4.4
#> 30:     12.5              25  20.0 m              5.3                      26                 8.3
#> 31:     11.9              25 300.0 m              2.1                      26                10.3
#> 32:     11.3              25 300.0 m              3.1                      26                 9.5
#> 33:      9.4              25 300.0 m              2.8                      26                 9.7
#> 34:     12.7              25 300.0 m              3.8                      26                 9.5
#> 35:     14.2              25 300.0 m              3.2                      26                 9.7
#> 36:     10.5              25 210.0 m              4.6                      26                 9.8
#> 37:     10.5              25 210.0 m              5.3                      26                 8.4
#> 38:      8.8              25 210.0 m              3.5                      26                 9.7
#> 39:     12.0              25 210.0 m              4.6                      26                 7.1
#> 40:     12.5              25 210.0 m              3.3                      26                 7.6
#> 41:     13.4              25 340.0 m              2.2                      26                11.7
#> 42:     11.7              25 340.0 m              3.0                      26                 9.7
#> 43:     13.1              25 340.0 m              1.8                      26                11.7
#> 44:     13.7              25 340.0 m              3.2                      26                10.4
#> 45:     15.2              25 340.0 m              2.8                      26                10.4
#> 46:     11.7              25 340.0 m              2.8                      26                10.7
#> 47:     11.2              25 340.0 m              3.2                      26                 9.3
#> 48:      9.4              25 340.0 m              3.1                      26                 9.9
#> 49:     12.6              25 340.0 m              3.7                      26                 9.5
#> 50:     13.6              25 340.0 m              3.1                      26                 9.5
#>     air_tmin air_tmin_source  elev_m et_morton_actual et_morton_actual_source et_morton_potential
#>     et_morton_potential_source et_morton_wet et_morton_wet_source et_short_crop et_short_crop_source
#>                          <int>         <num>                <int>         <num>                <int>
#>  1:                         26           7.3                   26           7.7                   26
#>  2:                         26           7.2                   26           5.7                   26
#>  3:                         26           7.1                   26           6.3                   26
#>  4:                         26           6.2                   26           4.9                   26
#>  5:                         26           5.7                   26           5.1                   26
#>  6:                         26           7.0                   26           7.2                   26
#>  7:                         26           6.8                   26           7.4                   26
#>  8:                         26           7.0                   26           8.2                   26
#>  9:                         26           6.8                   26           7.7                   26
#> 10:                         26           4.5                   26           5.9                   26
#> 11:                         26           7.3                   26           5.5                   26
#> 12:                         26           6.1                   26           4.9                   26
#> 13:                         26           7.4                   26           6.6                   26
#> 14:                         26           3.2                   26           2.2                   26
#> 15:                         26           5.1                   26           4.7                   26
#> 16:                         26           7.5                   26           8.8                   26
#> 17:                         26           7.4                   26           8.3                   26
#> 18:                         26           7.2                   26           8.4                   26
#> 19:                         26           7.8                   26           9.1                   26
#> 20:                         26           7.2                   26           9.1                   26
#> 21:                         26           6.7                   26           8.1                   26
#> 22:                         26           6.1                   26           6.7                   26
#> 23:                         26           6.6                   26           7.9                   26
#> 24:                         26           6.6                   26           7.4                   26
#> 25:                         26           6.5                   26           7.3                   26
#> 26:                         26           6.8                   26           5.0                   26
#> 27:                         26           7.0                   26           5.7                   26
#> 28:                         26           7.0                   26           5.3                   26
#> 29:                         26           3.9                   26           3.3                   26
#> 30:                         26           6.8                   26           5.6                   26
#> 31:                         26           6.2                   26           7.6                   26
#> 32:                         26           6.3                   26           6.6                   26
#> 33:                         26           6.3                   26           7.3                   26
#> 34:                         26           6.6                   26           7.0                   26
#> 35:                         26           6.4                   26           7.0                   26
#> 36:                         26           7.2                   26           7.2                   26
#> 37:                         26           6.8                   26           6.0                   26
#> 38:                         26           6.6                   26           7.0                   26
#> 39:                         26           5.8                   26           5.2                   26
#> 40:                         26           5.5                   26           5.4                   26
#> 41:                         26           7.0                   26           8.2                   26
#> 42:                         26           6.3                   26           6.7                   26
#> 43:                         26           6.7                   26           8.0                   26
#> 44:                         26           6.8                   26           7.4                   26
#> 45:                         26           6.6                   26           7.4                   26
#> 46:                         26           6.8                   26           7.9                   26
#> 47:                         26           6.3                   26           6.5                   26
#> 48:                         26           6.5                   26           7.4                   26
#> 49:                         26           6.6                   26           7.0                   26
#> 50:                         26           6.3                   26           6.9                   26
#>     et_morton_potential_source et_morton_wet et_morton_wet_source et_short_crop et_short_crop_source
#>     et_tall_crop et_tall_crop_source evap_comb evap_comb_source evap_morton_lake
#>            <num>               <int>     <num>            <int>            <num>
#>  1:         10.2                  26      10.0               25              7.5
#>  2:          6.9                  26       7.4               25              7.4
#>  3:          8.1                  26       6.6               25              7.3
#>  4:          5.7                  26       8.7               25              6.4
#>  5:          6.3                  26       7.7               25              5.9
#>  6:          9.0                  26      10.8               25              8.2
#>  7:          9.5                  26      11.4               25              8.0
#>  8:         11.0                  26      10.7               25              8.2
#>  9:         10.1                  26      10.0               25              8.0
#> 10:          7.9                  26       9.7               25              5.2
#> 11:          6.5                  26       8.0               25              7.6
#> 12:          5.8                  26       6.0               25              6.3
#> 13:          8.3                  26       6.7               25              7.6
#> 14:          2.4                  26       5.1               25              3.2
#> 15:          5.8                  26       7.4               25              5.3
#> 16:         11.7                  26      14.3               25              8.7
#> 17:         10.9                  26      15.4               25              8.6
#> 18:         11.2                  26      13.6               25              8.5
#> 19:         12.2                  26      14.0               25              9.0
#> 20:         12.7                  26      14.9               25              8.4
#> 21:         10.9                  26      10.6               25              7.8
#> 22:          8.7                  26       9.0               25              7.2
#> 23:         10.5                  26       9.3               25              7.7
#> 24:          9.5                  26      10.9               25              7.7
#> 25:          9.5                  26       9.2               25              7.6
#> 26:          5.7                  26       4.7               25              7.0
#> 27:          7.0                  26       5.0               25              7.2
#> 28:          6.2                  26       5.2               25              7.3
#> 29:          3.9                  26       5.4               25              4.0
#> 30:          6.8                  26       5.0               25              7.0
#> 31:         10.2                  26      10.1               25              7.2
#> 32:          8.4                  26       8.6               25              7.4
#> 33:          9.6                  26       8.6               25              7.3
#> 34:          8.9                  26       9.2               25              7.8
#> 35:          9.0                  26       9.3               25              7.5
#> 36:          9.1                  26       8.1               25              8.0
#> 37:          7.2                  26       6.8               25              7.7
#> 38:          9.1                  26       7.2               25              7.4
#> 39:          6.2                  26       6.7               25              6.5
#> 40:          6.7                  26       7.3               25              6.1
#> 41:         10.9                  26      11.0               25              8.1
#> 42:          8.7                  26       9.3               25              7.5
#> 43:         10.7                  26       9.5               25              7.9
#> 44:          9.6                  26      11.5               25              7.9
#> 45:          9.5                  26       9.7               25              7.7
#> 46:         10.4                  26       9.4               25              7.9
#> 47:          8.3                  26       8.2               25              7.3
#> 48:          9.7                  26       8.4               25              7.5
#> 49:          8.9                  26       9.1               25              7.7
#> 50:          8.8                  26       8.7               25              7.3
#>     et_tall_crop et_tall_crop_source evap_comb evap_comb_source evap_morton_lake
#>     evap_morton_lake_source evap_pan evap_pan_source evap_syn evap_syn_source  extracted latitude
#>                       <int>    <num>           <int>    <num>           <int>     <Date>    <num>
#>  1:                      26     10.0              25     10.0              26 2024-06-05 -33.8811
#>  2:                      26      7.4              25      7.7              26 2024-06-05 -33.8811
#>  3:                      26      6.6              25      8.6              26 2024-06-05 -33.8811
#>  4:                      26      8.7              25      7.0              26 2024-06-05 -33.8811
#>  5:                      26      7.7              25      7.0              26 2024-06-05 -33.8811
#>  6:                      26     10.8              25     10.6              26 2024-06-05 -27.9607
#>  7:                      26     11.4              25     10.8              26 2024-06-05 -27.9607
#>  8:                      26     10.7              25     12.2              26 2024-06-05 -27.9607
#>  9:                      26     10.0              25     11.3              26 2024-06-05 -27.9607
#> 10:                      26      9.7              25      9.4              26 2024-06-05 -27.9607
#> 11:                      26      8.0              25      7.5              26 2024-06-05 -35.0289
#> 12:                      26      6.0              25      6.5              26 2024-06-05 -35.0289
#> 13:                      26      6.7              25      8.4              26 2024-06-05 -35.0289
#> 14:                      26      5.1              25      3.4              26 2024-06-05 -35.0289
#> 15:                      26      7.4              25      6.0              26 2024-06-05 -35.0289
#> 16:                      26     14.3              25     15.3              26 2024-06-05 -27.2878
#> 17:                      26     15.4              25     14.3              26 2024-06-05 -27.2878
#> 18:                      26     13.6              25     14.5              26 2024-06-05 -27.2878
#> 19:                      26     14.0              25     16.0              26 2024-06-05 -27.2878
#> 20:                      26     14.9              25     16.6              26 2024-06-05 -27.2878
#> 21:                      26     10.6              25     11.8              26 2024-06-05 -31.4453
#> 22:                      26      9.0              25      9.8              26 2024-06-05 -31.4453
#> 23:                      26      9.3              25     11.4              26 2024-06-05 -31.4453
#> 24:                      26     10.9              25     10.5              26 2024-06-05 -31.4453
#> 25:                      26      9.2              25     10.5              26 2024-06-05 -31.4453
#> 26:                      26      4.7              25      6.0              26 2024-06-05 -34.1597
#> 27:                      26      5.0              25      6.6              26 2024-06-05 -34.1597
#> 28:                      26      5.2              25      6.5              26 2024-06-05 -34.1597
#> 29:                      26      5.4              25      4.2              26 2024-06-05 -34.1597
#> 30:                      26      5.0              25      6.5              26 2024-06-05 -34.1597
#> 31:                      26     10.1              25     10.4              26 2024-06-05 -32.6322
#> 32:                      26      8.6              25      8.7              26 2024-06-05 -32.6322
#> 33:                      26      8.6              25      9.8              26 2024-06-05 -32.6322
#> 34:                      26      9.2              25      9.2              26 2024-06-05 -32.6322
#> 35:                      26      9.3              25      9.1              26 2024-06-05 -32.6322
#> 36:                      26      8.1              25      9.1              26 2024-06-05 -34.2553
#> 37:                      26      6.8              25      7.7              26 2024-06-05 -34.2553
#> 38:                      26      7.2              25      8.9              26 2024-06-05 -34.2553
#> 39:                      26      6.7              25      6.8              26 2024-06-05 -34.2553
#> 40:                      26      7.3              25      6.9              26 2024-06-05 -34.2553
#> 41:                      26     11.0              25     12.0              26 2024-06-05 -31.1683
#> 42:                      26      9.3              25     10.0              26 2024-06-05 -31.1683
#> 43:                      26      9.5              25     11.7              26 2024-06-05 -31.1683
#> 44:                      26     11.5              25     10.8              26 2024-06-05 -31.1683
#> 45:                      26      9.7              25     10.7              26 2024-06-05 -31.1683
#> 46:                      26      9.4              25     10.5              26 2024-06-05 -32.6597
#> 47:                      26      8.2              25      8.6              26 2024-06-05 -32.6597
#> 48:                      26      8.4              25      9.8              26 2024-06-05 -32.6597
#> 49:                      26      9.1              25      9.1              26 2024-06-05 -32.6597
#> 50:                      26      8.7              25      9.0              26 2024-06-05 -32.6597
#>     evap_morton_lake_source evap_pan evap_pan_source evap_syn evap_syn_source  extracted latitude
#>     longitude   mslp mslp_source radiation radiation_source rainfall rainfall_source rh_tmax
#>         <num>  <num>       <int>     <num>            <int>    <num>           <int>   <num>
#>  1:  122.2167 1014.7          25      30.9               42      0.0               0    18.6
#>  2:  122.2167 1018.0          25      32.6               42      0.2               0    44.3
#>  3:  122.2167 1020.4          25      33.1               42      0.0               0    25.7
#>  4:  122.2167 1016.8          25      28.2               42      0.0               0    50.9
#>  5:  122.2167 1021.4          25      25.8               42      0.0               0    43.9
#>  6:  114.6336 1009.4          25      32.4               42      0.0               0    29.7
#>  7:  114.6336 1015.9          25      33.1               42      0.0               0    22.8
#>  8:  114.6336 1012.8          25      32.7               42      0.0               0    15.3
#>  9:  114.6336 1010.5          25      32.3               42      0.0               0    19.7
#> 10:  114.6336 1009.5          25      19.6               42      0.0               0    28.2
#> 11:  117.8808 1012.7          25      33.5               42      0.0               0    41.5
#> 12:  117.8808 1020.1          25      29.3               42      0.0               0    47.7
#> 13:  117.8808 1019.1          25      33.2               42      0.0               0    27.6
#> 14:  117.8808 1018.7          25      12.7               42      0.0               0    75.1
#> 15:  117.8808 1020.4          25      24.3               42      0.0               0    44.2
#> 16:  120.3919 1010.7          25      31.9               42      0.0               0    15.2
#> 17:  120.3919 1009.3          25      32.5               42      0.0               0    17.3
#> 18:  120.3919 1014.0          25      32.9               42      0.0               0    13.6
#> 19:  120.3919 1009.3          25      32.8               42      0.0               0    12.5
#> 20:  120.3919 1008.9          25      31.2               42      0.0               0     7.6
#> 21:  117.2219 1012.5          25      31.6               42      0.0               0    15.9
#> 22:  117.2219 1018.6          25      31.4               42      0.0               0    22.5
#> 23:  117.2219 1017.3          25      31.4               42      0.0               0    16.4
#> 24:  117.2219 1015.3          25      31.0               42      0.0               0    23.1
#> 25:  117.2219 1014.9          25      30.4               42      0.0               0    23.6
#> 26:  115.1892 1014.8          25      31.0               42      0.0               0    52.1
#> 27:  115.1892 1021.3          25      32.6               42      0.0               0    37.5
#> 28:  115.1892 1019.5          25      32.8               42      0.0               0    42.1
#> 29:  115.1892 1018.9          25      18.1               42      0.0               0    62.9
#> 30:  115.1892 1018.2          25      31.0               42      0.0               0    40.0
#> 31:  119.0958 1012.4          25      29.0               42      0.0               0    18.9
#> 32:  119.0958 1017.8          25      32.3               42      0.0               0    24.4
#> 33:  119.0958 1018.2          25      30.9               42      0.0               0    19.8
#> 34:  119.0958 1015.6          25      31.8               42      0.0               0    26.7
#> 35:  119.0958 1016.8          25      30.4               42      0.0               0    26.5
#> 36:  118.2214 1012.7          25      33.4               42      0.0               0    25.0
#> 37:  118.2214 1019.4          25      33.8               42      0.0               0    36.0
#> 38:  118.2214 1018.8          25      32.0               42      0.0               0    21.0
#> 39:  118.2214 1017.9          25      29.0               42      0.0               0    43.8
#> 40:  118.2214 1019.2          25      27.2               42      0.0               0    36.2
#> 41:  117.0736 1012.3          25      32.3               42      0.0               0    16.6
#> 42:  117.0736 1018.4          25      32.3               42      0.0               0    23.7
#> 43:  117.0736 1016.9          25      32.0               42      0.0               0    15.7
#> 44:  117.0736 1014.9          25      31.9               42      0.0               0    23.3
#> 45:  117.0736 1014.3          25      30.5               42      0.0               0    24.0
#> 46:  118.6319 1012.4          25      31.7               42      0.0               0    19.0
#> 47:  118.6319 1018.1          25      32.2               42      0.0               0    25.2
#> 48:  118.6319 1018.1          25      31.7               42      0.0               0    20.0
#> 49:  118.6319 1015.8          25      31.6               42      0.0               0    26.7
#> 50:  118.6319 1016.6          25      30.1               42      0.0               0    26.3
#>     longitude   mslp mslp_source radiation radiation_source rainfall rainfall_source rh_tmax
#>     rh_tmax_source rh_tmin rh_tmin_source    vp vp_deficit vp_deficit_source vp_source
#>              <int>   <num>          <int> <num>      <num>             <int>     <int>
#>  1:             26    77.4             26  10.5       30.0                26        25
#>  2:             26    63.3             26  11.0       11.8                26        25
#>  3:             26    80.2             26   8.9       17.5                26        25
#>  4:             26    95.5             26  14.3        9.8                26        25
#>  5:             26    73.6             26  12.7       12.8                26        25
#>  6:             26    87.9             26  14.6       23.4                26        25
#>  7:             26    55.9             26   9.9       25.1                26        25
#>  8:             26    49.0             26   8.9       35.3                26        25
#>  9:             26    51.8             26   9.9       30.0                26        25
#> 10:             26    74.9             26  14.5       26.3                26        25
#> 11:             26   100.0             26  12.6       11.3                26        25
#> 12:             26    78.5             26  11.0        9.4                26        25
#> 13:             26    98.5             26  11.0       18.5                26        25
#> 14:             26   100.0             26  15.5        3.4                26        25
#> 15:             26    72.9             26  11.2       11.2                26        25
#> 16:             26    40.9             26  10.8       45.4                26        25
#> 17:             26    37.7             26   9.9       37.5                26        25
#> 18:             26    33.2             26   7.8       38.4                26        25
#> 19:             26    33.3             26   9.3       49.7                26        25
#> 20:             26    26.1             26   6.3       55.4                26        25
#> 21:             26    72.0             26   9.9       33.8                26        25
#> 22:             26    60.6             26   8.6       21.6                26        25
#> 23:             26    64.5             26   9.4       32.1                26        25
#> 24:             26    74.5             26  11.9       27.1                26        25
#> 25:             26    71.1             26  12.2       27.6                26        25
#> 26:             26   100.0             26  14.1        8.8                26        25
#> 27:             26    69.7             26   9.9       12.8                26        25
#> 28:             26   100.0             26  12.2       10.6                26        25
#> 29:             26    95.7             26  14.8        6.4                26        25
#> 30:             26    81.5             26  11.8       13.0                26        25
#> 31:             26    83.3             26  11.6       31.9                26        25
#> 32:             26    66.5             26   8.9       19.8                26        25
#> 33:             26    87.4             26  10.3       26.5                26        25
#> 34:             26    85.2             26  12.5       23.0                26        25
#> 35:             26    77.9             26  12.6       24.2                26        25
#> 36:             26    92.2             26  11.7       22.7                26        25
#> 37:             26    85.1             26  10.8       13.6                26        25
#> 38:             26    83.0             26   9.4       23.0                26        25
#> 39:             26    87.8             26  12.3       11.4                26        25
#> 40:             26    75.9             26  11.0       14.4                26        25
#> 41:             26    67.0             26  10.3       34.5                26        25
#> 42:             26    66.2             26   9.1       21.0                26        25
#> 43:             26    60.4             26   9.1       33.3                26        25
#> 44:             26    76.6             26  12.0       26.9                26        25
#> 45:             26    73.0             26  12.6       27.8                26        25
#> 46:             26    82.2             26  11.3       30.9                26        25
#> 47:             26    68.5             26   9.1       19.3                26        25
#> 48:             26    87.4             26  10.3       26.2                26        25
#> 49:             26    85.0             26  12.4       22.9                26        25
#> 50:             26    79.0             26  12.3       23.7                26        25
#>     rh_tmax_source rh_tmin rh_tmin_source    vp vp_deficit vp_deficit_source vp_source
```

## References
